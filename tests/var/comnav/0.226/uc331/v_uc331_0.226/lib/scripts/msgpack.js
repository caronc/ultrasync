/*!{id:msgpack.js,ver:1.05,license:"MIT",author:"uupaa.js@gmail.com"}*/
;this.msgpack||(function(s){s.msgpack={pack:c,unpack:m,worker:"msgpack.js",upload:f,download:n};var e=/MSIE/.test(navigator.userAgent),d={},b={},u=("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").split(""),a=[],t=0,i=0,l=Array.isArray||(function(w){return Object.prototype.toString.call(w)==="[object Array]"}),v=String.fromCharCode,k=512;self.importScripts&&(onmessage=function(w){if(w.data.method==="pack"){postMessage(q(c(w.data.data)))}else{postMessage(m(w.data.data))}});function c(x,y){i=0;var w=h([],x,0);return i?false:y?r(w):w}function m(w){a=typeof w==="string"?g(w):w;t=-1;return p()}function h(z,H,C){var I,D,x,F,G,B,E,y,A,w;if(H==null){z.push(192)}else{if(H===false){z.push(194)}else{if(H===true){z.push(195)}else{switch(typeof H){case"number":if(H!==H){z.push(203,255,255,255,255,255,255,255,255)}else{if(H===Infinity){z.push(203,127,240,0,0,0,0,0,0)}else{if(Math.floor(H)===H){if(H<0){if(H>=-32){z.push(224+H+32)}else{if(H>-128){z.push(208,H+256)}else{if(H>-32768){H+=65536;z.push(209,H>>8,H&255)}else{if(H>-2147483648){H+=4294967296;z.push(210,H>>>24,(H>>16)&255,(H>>8)&255,H&255)}else{B=Math.floor(H/4294967296);E=H&4294967295;z.push(211,(B>>24)&255,(B>>16)&255,(B>>8)&255,B&255,(E>>24)&255,(E>>16)&255,(E>>8)&255,E&255)}}}}}else{if(H<128){z.push(H)}else{if(H<256){z.push(204,H)}else{if(H<65536){z.push(205,H>>8,H&255)}else{if(H<4294967296){z.push(206,H>>>24,(H>>16)&255,(H>>8)&255,H&255)}else{B=Math.floor(H/4294967296);E=H&4294967295;z.push(207,(B>>24)&255,(B>>16)&255,(B>>8)&255,B&255,(E>>24)&255,(E>>16)&255,(E>>8)&255,E&255)}}}}}}else{y=H<0;y&&(H*=-1);A=((Math.log(H)/0.6931471805599453)+1023)|0;w=H*Math.pow(2,52+1023-A);E=w&4294967295;y&&(A|=2048);B=((w/4294967296)&1048575)|(A<<20);z.push(203,(B>>24)&255,(B>>16)&255,(B>>8)&255,B&255,(E>>24)&255,(E>>16)&255,(E>>8)&255,E&255)}}}break;case"string":x=H.length;G=z.length;z.push(0);for(D=0;D<x;++D){F=H.charCodeAt(D);if(F<128){z.push(F&127)}else{if(F<2048){z.push(((F>>>6)&31)|192,(F&63)|128)}else{if(F<65536){z.push(((F>>>12)&15)|224,((F>>>6)&63)|128,(F&63)|128)}}}}I=z.length-G-1;if(I<32){z[G]=160+I}else{if(I<65536){z.splice(G,1,218,I>>8,I&255)}else{if(I<4294967296){z.splice(G,1,219,I>>>24,(I>>16)&255,(I>>8)&255,I&255)}}}break;default:if(++C>=k){i=1;return z=[]}if(l(H)){I=H.length;if(I<16){z.push(144+I)}else{if(I<65536){z.push(220,I>>8,I&255)}else{if(I<4294967296){z.push(221,I>>>24,(I>>16)&255,(I>>8)&255,I&255)}}}for(D=0;D<I;++D){h(z,H[D],C)}}else{G=z.length;z.push(0);I=0;for(D in H){++I;h(z,D,C);h(z,H[D],C)}if(I<16){z[G]=128+I}else{if(I<65536){z.splice(G,1,222,I>>8,I&255)}else{if(I<4294967296){z.splice(G,1,223,I>>>24,(I>>16)&255,(I>>8)&255,I&255)}}}}}}}}return z}function p(){var H,D,z,G,E=0,A,B,w,y,C,x=a,F=x[++t];if(F>=224){return F-256}if(F<192){if(F<128){return F}if(F<144){E=F-128;F=128}else{if(F<160){E=F-144;F=144}else{E=F-160;F=160}}}switch(F){case 192:return null;case 194:return false;case 195:return true;case 202:E=x[++t]*16777216+(x[++t]<<16)+(x[++t]<<8)+x[++t];A=E&2147483648;B=(E>>23)&255;w=E&8388607;if(!E||E===2147483648){return 0}if(B===255){return w?NaN:Infinity}return(A?-1:1)*(w|8388608)*Math.pow(2,B-127-23);case 203:E=x[++t]*16777216+(x[++t]<<16)+(x[++t]<<8)+x[++t];A=E&2147483648;B=(E>>20)&2047;w=E&1048575;if(!E||E===2147483648){t+=4;return 0}if(B===2047){t+=4;return w?NaN:Infinity}E=x[++t]*16777216+(x[++t]<<16)+(x[++t]<<8)+x[++t];return(A?-1:1)*((w|1048576)*Math.pow(2,B-1023-20)+E*Math.pow(2,B-1023-52));case 207:E=x[++t]*16777216+(x[++t]<<16)+(x[++t]<<8)+x[++t];return E*4294967296+x[++t]*16777216+(x[++t]<<16)+(x[++t]<<8)+x[++t];case 206:E+=x[++t]*16777216+(x[++t]<<16);case 205:E+=x[++t]<<8;case 204:return E+x[++t];case 211:E=x[++t];if(E&128){return((E^255)*72057594037927940+(x[++t]^255)*281474976710656+(x[++t]^255)*1099511627776+(x[++t]^255)*4294967296+(x[++t]^255)*16777216+(x[++t]^255)*65536+(x[++t]^255)*256+(x[++t]^255)+1)*-1}return E*72057594037927940+x[++t]*281474976710656+x[++t]*1099511627776+x[++t]*4294967296+x[++t]*16777216+x[++t]*65536+x[++t]*256+x[++t];case 210:E=x[++t]*16777216+(x[++t]<<16)+(x[++t]<<8)+x[++t];return E<2147483648?E:E-4294967296;case 209:E=(x[++t]<<8)+x[++t];return E<32768?E:E-65536;case 208:E=x[++t];return E<128?E:E-256;case 219:E+=x[++t]*16777216+(x[++t]<<16);case 218:E+=(x[++t]<<8)+x[++t];case 160:for(y=[],D=t,z=D+E;D<z;){G=x[++D];y.push(G<128?G:G<224?((G&31)<<6|(x[++D]&63)):((G&15)<<12|(x[++D]&63)<<6|(x[++D]&63)))}t=D;return y.length<10240?v.apply(null,y):r(y);case 223:E+=x[++t]*16777216+(x[++t]<<16);case 222:E+=(x[++t]<<8)+x[++t];case 128:C={};while(E--){H=x[++t]-160;for(y=[],D=t,z=D+H;D<z;){G=x[++D];y.push(G<128?G:G<224?((G&31)<<6|(x[++D]&63)):((G&15)<<12|(x[++D]&63)<<6|(x[++D]&63)))}t=D;C[v.apply(null,y)]=p()}return C;case 221:E+=x[++t]*16777216+(x[++t]<<16);case 220:E+=(x[++t]<<8)+x[++t];case 144:y=[];while(E--){y.push(p())}return y}return}function r(x){try{return v.apply(this,x)}catch(z){}var B=[],y=0,A=x.length,w=b;for(;y<A;++y){B[y]=w[x[y]]}return B.join("")}function n(w,x,y){x.method="GET";x.binary=true;o(w,x,y)}function f(w,x,z){x.method="PUT";x.binary=true;if(x.worker&&s.Worker){var y=new Worker(msgpack.worker);y.onmessage=function(A){x.data=A.data;o(w,x,z)};y.postMessage({method:"pack",data:x.data})}else{x.data=q(c(x.data));o(w,x,z)}}function o(z,G,B){function H(){if(E.readyState===4){var R,Q=E.status,S,P,T={status:Q,ok:Q>=200&&Q<300};if(!I++){if(x==="PUT"){R=T.ok?E.responseText:""}else{if(T.ok){if(G.worker&&s.Worker){S=new Worker(msgpack.worker);S.onmessage=function(U){B(U.data,G,T)};S.postMessage({method:"unpack",data:E.responseText});M();return}else{P=e?j(E):g(E.responseText);R=m(P)}}}y&&y(E,G,T);B(R,G,T);M()}}}function C(R,P){if(!I++){var Q={status:P||400,ok:false};y&&y(E,G,Q);B(null,G,Q);M(R)}}function M(P){P&&E&&E.abort&&E.abort();L&&(clearTimeout(L),L=0);E=null;s.addEventListener&&s.removeEventListener("beforeunload",C,false)}var L=0,x=G.method||"GET",J=G.header||{},F=G.before,y=G.after,O=G.data||null,E=s.XMLHttpRequest?new XMLHttpRequest():s.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null,I=0,K,D="overrideMimeType",N="setRequestHeader",w=x==="GET"&&G.binary;try{E.onreadystatechange=H;E.open(x,z,true);F&&F(E,G);w&&E[D]&&E[D]("text/plain; charset=x-user-defined");O&&E[N]("Content-Type","application/x-www-form-urlencoded");for(K in J){E[N](K,J[K])}s.addEventListener&&s.addEventListener("beforeunload",C,false);E.send(O);L=setTimeout(function(){C(1,408)},(G.timeout||10)*1000)}catch(A){C(0,400)}}function g(z){var C=[],y=d,B,x=z.split(""),w=-1,A;A=x.length;B=A%8;while(B--){++w;C[w]=y[x[w]]}B=A>>3;while(B--){C.push(y[x[++w]],y[x[++w]],y[x[++w]],y[x[++w]],y[x[++w]],y[x[++w]],y[x[++w]],y[x[++w]])}return C}function j(L){var x=[],A,C,y="charCodeAt",B,K,J,I,H,G,F,E,D,z=-1,w;w=vblen(L);A=vbstr(L);B=Math.ceil(w/2);C=B%8;while(C--){K=A[y](++z);x.push(K&255,K>>8)}C=B>>3;while(C--){K=A[y](++z);J=A[y](++z);I=A[y](++z);H=A[y](++z);G=A[y](++z);F=A[y](++z);E=A[y](++z);D=A[y](++z);x.push(K&255,K>>8,J&255,J>>8,I&255,I>>8,H&255,H>>8,G&255,G>>8,F&255,F>>8,E&255,E>>8,D&255,D>>8)}w%2&&x.pop();return x}function q(z){var D=[],C=0,y=-1,B=z.length,A=[0,2,1][z.length%3],x=b,w=u;if(s.btoa){while(y<B){D.push(x[z[++y]])}return btoa(D.join(""))}--B;while(y<B){C=(z[++y]<<16)|(z[++y]<<8)|(z[++y]);D.push(w[(C>>18)&63],w[(C>>12)&63],w[(C>>6)&63],w[C&63])}A>1&&(D[D.length-2]="=");A>0&&(D[D.length-1]="=");return D.join("")}(function(){var x=0,w;for(;x<256;++x){w=v(x);d[w]=x;b[x]=w}for(x=128;x<256;++x){d[v(63232+x)]=x}})();e&&document.write('<script type="text/vbscript">Function vblen(b)vblen=LenB(b.responseBody)End Function\nFunction vbstr(b)vbstr=CStr(b.responseBody)+chr(0)End Function<\/script>')})(this);